--[[
  BloodDebt ESP Pure v3.1
  Features:
  - –£–ª—å—Ç—Ä–∞-–±—ã—Å—Ç—Ä–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ (0.5 —Å–µ–∫)
  - –ù–µ—Ç UI —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
  - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
  - –¢–æ–ª—å–∫–æ core-—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª
]]

-- üî´ –°–ø–∏—Å–∫–∏ –æ—Ä—É–∂–∏—è
local WEAPONS = {
    MURDERER = {
        ["JS-2 DERRINGY"] = true, ["JS-22"] = true, ["RR-LCP"] = true,
        ["Sawn-Off"] = true, ["Rosen-Obrez"] = true, ["K1911"] = true,
        ["SKORPION"] = true, ["ZZ-90"] = true, ["SILVER STEEL K1911"] = true,
        ["Clothed Rosen-Obrez"] = true, ["Clother Sawn-Off"] = true,
        ["Kamatov"] = true, ["GLIDED"] = true, ["JS-2 BONDS DERRINGY"] = true,
        ["Charcoal Steel JS-22"] = true, ["Pretty Pink RR-LCP"] = true
    },
    SHERIFF = {
        ["RR-Snubby"] = true, ["GG-17"] = true, ["J9-M"] = true,
        ["I-412"] = true, ["Silver Steel RR-Snubby"] = true
    },
    JUGGERNAUT = {
        ["ANKM"] = true, ["AT's KAR15"] = true
    },
    INNOCENT = {
        ["Lead Pipe"] = true, ["Kitchen Knife"] = true, ["Boxcutters"] = true
    }
}

-- üõ† –°–µ—Ä–≤–∏—Å—ã
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")

-- ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏
local UPDATE_INTERVAL = 0.5  -- –ß–∞—Å—Ç–æ—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ä–æ–ª–µ–π
local MAX_DISTANCE = 200     -- –î–∏—Å—Ç–∞–Ω—Ü–∏—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ (studs)

-- üé® –¶–≤–µ—Ç–∞
local COLORS = {
    Murderer = Color3.fromRGB(255, 50, 50),
    Sheriff = Color3.fromRGB(50, 50, 255),
    Juggernaut = Color3.fromRGB(180, 0, 0),
    Innocent = Color3.fromRGB(50, 255, 50),
    Armed = Color3.fromRGB(175, 255, 255)
}

-- üîÑ –ö—ç—à
local PlayerCache = {}

-- ‚ôªÔ∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞
local function SafeCreate(instance, parent, properties)
    local obj = Instance.new(instance)
    for prop, val in pairs(properties) do
        obj[prop] = val
    end
    obj.Parent = parent
    return obj
end

-- üîç –ë—ã—Å—Ç—Ä–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–æ–ª–∏
local function DetermineRole(player)
    local items = {}
    
    -- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
    local backpack = player:FindFirstChild("Backpack")
    if backpack then
        for _, item in ipairs(backpack:GetChildren()) do
            table.insert(items, item.Name)
        end
    end

    -- –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ä—É–∂–∏—è –≤ —Ä—É–∫–∞—Ö
    local character = player.Character
    if character then
        for _, item in ipairs(character:GetChildren()) do
            if item:IsA("Tool") then
                table.insert(items, item.Name)
            end
        end
    end

    -- –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–µ–π
    for _, item in ipairs(items) do
        if WEAPONS.MURDERER[item] then return "Murderer" end
        if WEAPONS.SHERIFF[item] then return "Sheriff" end
        if WEAPONS.JUGGERNAUT[item] then return "Juggernaut" end
        if WEAPONS.INNOCENT[item] then return "Armed", item end
    end

    return "Innocent"
end

-- ‚ú® –ü–ª–∞–≤–Ω–∞—è –ø–æ–¥—Å–≤–µ—Ç–∫–∞
local function HighlightPlayer(player, role)
    local character = player.Character
    if not character then return end

    -- –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä–æ–π –ø–æ–¥—Å–≤–µ—Ç–∫–∏
    for _, child in ipairs(character:GetDescendants()) do
        if child.Name == "RoleHighlight" then
            child:Destroy()
        end
    end

    local highlight = SafeCreate("Highlight", character, {
        Name = "RoleHighlight",
        FillTransparency = 0.8,
        OutlineTransparency = 0.5,
        FillColor = COLORS[role] or COLORS.Innocent,
        OutlineColor = Color3.new(0, 0, 0)
    })

    -- –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è
    local tween = TweenService:Create(highlight, TweenInfo.new(0.3), {
        FillTransparency = 0.7
    })
    tween:Play()
end

-- üè∑ –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ–≥–∞ —Å —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ–º
local function CreateNameTag(player, role, weapon)
    local character = player.Character
    if not character then return end

    local head = character:FindFirstChild("Head")
    if not head then return end

    -- –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä–æ–≥–æ —Ç–µ–≥–∞
    for _, child in ipairs(head:GetDescendants()) do
        if child.Name == "RoleTag" then
            child:Destroy()
        end
    end

    -- –†–∞—Å—á—ë—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è
    local distance = "??"
    local localPlayer = Players.LocalPlayer
    if localPlayer.Character and localPlayer.Character:FindFirstChild("HumanoidRootPart") then
        distance = math.floor((character.HumanoidRootPart.Position - localPlayer.Character.HumanoidRootPart.Position).Magnitude) .. " studs"
    end

    -- –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ–≥–∞
    local billboard = SafeCreate("BillboardGui", head, {
        Name = "RoleTag",
        Size = UDim2.new(0, 200, 0, 50),
        StudsOffset = Vector3.new(0, 3, 0),
        AlwaysOnTop = true,
        MaxDistance = MAX_DISTANCE,
        Active = true
    })

    local label = SafeCreate("TextLabel", billboard, {
        Size = UDim2.new(1, 0, 1, 0),
        BackgroundTransparency = 1,
        Font = Enum.Font.SourceSansBold,
        TextSize = 18,
        TextStrokeTransparency = 0.5,
        TextColor3 = COLORS[role] or COLORS.Innocent
    })

    -- –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞
    if role == "Armed" then
        label.Text = string.format("%s\n‚öî %s (%s)", player.Name, weapon, distance)
    elseif role == "Innocent" then
        label.Text = string.format("%s (%s)", player.Name, distance)
    else
        label.Text = string.format("%s: %s (%s)", role:upper(), player.Name, distance)
    end
end

-- üë§ –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–≥—Ä–æ–∫–∞
local function ProcessPlayer(player)
    local function SetupCharacter(character)
        if not character then return end

        -- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–º–µ—Ä—Ç–∏
        character:WaitForChild("Humanoid").Died:Connect(function()
            for _, child in ipairs(character:GetDescendants()) do
                if child.Name == "RoleHighlight" or child.Name == "RoleTag" then
                    pcall(child.Destroy, child)
                end
            end
        end)

        -- –û—Ç–ª–æ–∂–µ–Ω–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        task.delay(1, function()
            if not character or not character.Parent then return end
            local role, weapon = DetermineRole(player)
            HighlightPlayer(player, role)
            CreateNameTag(player, role, weapon)
        end)
    end

    -- –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Å–æ–±—ã—Ç–∏—è
    player.CharacterAdded:Connect(SetupCharacter)
    if player.Character then
        task.spawn(SetupCharacter, player.Character)
    end
end

-- üîÑ –û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª
local function MainLoop()
    -- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤
    for _, player in ipairs(Players:GetPlayers()) do
        ProcessPlayer(player)
    end

    -- –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–æ–≤—ã—Ö –∏–≥—Ä–æ–∫–æ–≤
    Players.PlayerAdded:Connect(ProcessPlayer)

    -- –ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
    while true do
        for _, player in ipairs(Players:GetPlayers()) do
            if player.Character then
                local role, weapon = DetermineRole(player)
                HighlightPlayer(player, role)
                CreateNameTag(player, role, weapon)
            end
        end
        task.wait(UPDATE_INTERVAL)
    end
end

-- ‚ö° –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã
RunService.Heartbeat:Connect(function()
    pcall(MainLoop)
end)

print("[BloodDebt ESP] –°–∏—Å—Ç–µ–º–∞ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞ —Å —á–∞—Å—Ç–æ—Ç–æ–π –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è "..UPDATE_INTERVAL.." —Å–µ–∫")
